---
title: "ã€API_ kata_02ã€‘äº†è§£ request ç‰©ä»¶&POST API"
sidebar_position: 2
---


## ğŸŸ§ é–‹å ´ç™½


```js

const http = require("http");

// è«‹æ±‚ èˆ‡ å›è¦†
const requestListener = (req, res) => {

  console.log(req); //è¼¸å‡ºä½¿ç”¨è€…çš„è«‹æ±‚ç‰©ä»¶å…§å®¹ è§€å¯Ÿä¸€ä¸‹

  res.writeHead(200, { "Content-Type": "text/plain" }); // å›æ‡‰ header
  res.write("hello"); // å›æ‡‰å…§å®¹
  res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```



![ç¶²è·¯è«‹æ±‚](/img/req_01.png)

:::tip
```js
console.log(req.url);

console.log(req.method);
```
:::

- è«‹æ±‚èˆ‡å›æ‡‰ä¹Ÿå¯ä»¥ç”¨POSTMANå·¥å…·æ¸¬è©¦
![ç¶²è·¯è«‹æ±‚](/img/req02.png)

- æˆ‘å€‘å¯ä»¥é€éä½¿ç”¨è€…ç™¼éä¾†çš„è«‹æ±‚ä¸­çš„methodå’ŒurlçŸ¥é“ï¼Œä»–ç¾åœ¨è¦å°è©²apiåšå‡ºä»€éº¼æ¨£çš„å‹•ä½œ(crud)ä¾†è·Ÿç³»çµ±è¦è³‡æ–™

---

## ğŸŸ¦ å¯¦ä½œ

### 0ï¸âƒ£ æ–°å¢é¦–é æ¸¬è©¦ç¶²å€ & GET èˆ‡ 404 é é¢

```js

const http = require("http");

// è«‹æ±‚ èˆ‡ å›è¦†
const requestListener = (req, res) => {
  console.log(req.url);
  console.log(req.method); //è¼¸å‡ºä½¿ç”¨è€…çš„è«‹æ±‚ç‰©ä»¶å…§å®¹ è§€å¯Ÿä¸€ä¸‹
  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/" && req.method == "GET") { //é€²é¦–é 
    res.writeHead(200, { "Content-Type": "text/plain" }); // æˆåŠŸ å›æ‡‰ header
    res.write("index"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, { "Content-Type": "text/plain" }); // 404 å›æ‡‰ header
    res.write("not found"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

- ä¹Ÿå¯ä»¥æŠŠheaders æ”¶ç´èµ·ä¾†å…±ç”¨

```js

const http = require("http");

// è«‹æ±‚ èˆ‡ å›è¦†
const requestListener = (req, res) => {

  const headers = {
    { "Content-Type": "text/plain" }
  }

  console.log(req.url);
  console.log(req.method); //è¼¸å‡ºä½¿ç”¨è€…çš„è«‹æ±‚ç‰©ä»¶å…§å®¹ è§€å¯Ÿä¸€ä¸‹

  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/" && req.method == "GET") { //é€²é¦–é 
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write("index"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰

  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write("not found"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

![ç¶²è·¯è«‹æ±‚](/img/req_03.png)

### 1ï¸âƒ£ å¢åŠ é‡å°åŒä¸€å€‹ç¶²å€è³‡æºåšåˆªé™¤çš„è«‹æ±‚

```js

const http = require("http");

// è«‹æ±‚ èˆ‡ å›è¦†
const requestListener = (req, res) => {

  const headers = {
    { "Content-Type": "text/plain" }
  }

  console.log(req.url);
  console.log(req.method); //è¼¸å‡ºä½¿ç”¨è€…çš„è«‹æ±‚ç‰©ä»¶å…§å®¹ è§€å¯Ÿä¸€ä¸‹

  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write("index"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰

  } else if (req.url == "/" && req.method == "DELETE") { //åˆªé™¤è«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write("åˆªé™¤æˆåŠŸ"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰

  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write("not found"); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

### 2ï¸âƒ£ èª¿æ•´è¡¨é ­è³‡è¨Šï¼Œè¨­ç½®å›å‚³ JSON èˆ‡ cors è³‡è¨Š

```js

const http = require("http");

// è«‹æ±‚ èˆ‡ å›è¦†
const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' //è«‹æ±‚æ”¹æˆ"JSONæ ¼å¼"
}

  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": [],
    })); // é€™è£¡æ”¹æˆJSONæ ¼å¼ï¼Œä½†ç¶²è·¯è«‹æ±‚ä¸æœƒè§£æç‰©ä»¶é™£åˆ—ç­‰æ ¼å¼ï¼Œåªæ‡‚å­—ä¸²
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰

  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringigy({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

:::tip
JSONæ ¼å¼ï¼Œä½†ç¶²è·¯è«‹æ±‚(ç¶²è·¯å°åŒ…)ä¸æœƒè§£æç‰©ä»¶é™£åˆ—ç­‰æ ¼å¼ï¼Œåªæ‡‚å­—ä¸²ï¼Œæ‰€ä»¥æˆ‘å€‘è¦æŠŠJSONå­—ä¸²åŒ–
:::

![ç¶²è·¯è«‹æ±‚](/img/req_04.png)

- 404å›æ‡‰
![ç¶²è·¯è«‹æ±‚](/img/req_05.png)

---

### 3ï¸âƒ£ preflight options API æª¢æŸ¥æ©Ÿåˆ¶

```js
var requestOptions = {
  method: 'DELETE',
  redirect: 'follow'
};

fetch("https://intense-stream-02049.herokuapp.com/todos", requestOptions)
  .then(response => response.text())
  .then(result => console.log(result))
  .catch(error => console.log('error', error));
```

:::tip
è·¨ç¶²åŸŸè«‹æ±‚åœ¨æŸäº›æƒ…æ³æœƒè§¸ç™¼é æª¢æ©Ÿåˆ¶put/delete/patch..
ä¼ºæœå™¨èªª200ok ç€è¦½å™¨æ‰æœƒå†æ¬¡åšè«‹æ±‚
:::

- ![ç¶²è·¯è«‹æ±‚](/img/req_06.png)
- ![ç¶²è·¯è«‹æ±‚](/img/req_07.png)
- ![ç¶²è·¯è«‹æ±‚](/img/req_08.png)
- ![ç¶²è·¯è«‹æ±‚](/img/req_09.png)

### 4ï¸âƒ£ å¯¦ä½œï¼šè¨­å®š options API

```js

const http = require("http");

const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' //è«‹æ±‚æ”¹æˆ"JSONæ ¼å¼"
}

  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": [],
    })); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else if (req.method == "OPTIONS"){
    res.writeHead(200, headers); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringigy({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```
---

## ğŸŸ¦ API ä»‹ç´¹

- ![API](/img/api.png)

- ![API](/img/api_01.png)

### 0ï¸âƒ£ å¯¦ä½œï¼šå–å¾—æ‰€æœ‰ä»£è¾¦ã€å¢åŠ  UUID NPM (GET æ‰€æœ‰todos)

```js
const http = require("http");
const { v4: uuidv4 } = require('uuid'); //æ–°å¢æ¨¡çµ„
const todos = [ //è³‡æ–™åº«
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦é¢è©¦"
  },
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦åƒæ™šé¤"
  }
];

const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' //è«‹æ±‚æ”¹æˆ"JSONæ ¼å¼"
}

  //é‡å°è«‹æ±‚çš„ç¶²å€å°æµ åšä¸åŒçš„è™•ç†
  if(req.url == "/todos" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": todos,
    })); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else if (req.method == "OPTIONS"){
    res.writeHead(200, headers); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringigy({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

### 1ï¸âƒ£ POST API router ç’°å¢ƒå»ºç«‹

```js
const http = require("http");
const { v4: uuidv4 } = require('uuid'); //æ–°å¢æ¨¡çµ„
const todos = [ //è³‡æ–™åº«
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦é¢è©¦"
  },
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦åƒæ™šé¤"
  }
];

const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' 
}

  
  if(req.url == "/todos" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": todos,
    })); 
    res.end(); 
  } else if (req.url == "/todos" && req.method == "POST"){ //é€™è£¡
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": "1234"
    })); 
    res.end();
  } else if (req.method == "OPTIONS"){
    res.writeHead(200, headers); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringigy({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

### 2ï¸âƒ£ å¦‚ä½•æ¥æ”¶ POST API çš„ body è³‡æ–™ï¼Ÿ

:::tip
Node.js å®˜ç¶²æ¥æ”¶ buffer æ•™å­¸
:::

- ![å°åŒ…](/img/api_02.png)
```js
const http = require('node:http');

const server = http.createServer((req, res) => {
  // `req` is an http.IncomingMessage, which is a readable stream.
  // `res` is an http.ServerResponse, which is a writable stream.

  let body = '';
  // Get the data as utf8 strings.
  // If an encoding is not set, Buffer objects will be received.
  req.setEncoding('utf8');

  // Readable streams emit 'data' events once a listener is added.
  req.on('data', (chunk) => {
    body += chunk;
  });

  // The 'end' event indicates that the entire body has been received.
  req.on('end', () => {
    try {
      const data = JSON.parse(body);
      // Write back something interesting to the user:
      res.write(typeof data);
      res.end();
    } catch (er) {
      // uh oh! bad json!
      res.statusCode = 400;
      return res.end(`error: ${er.message}`);
    }
  });
});

server.listen(1337);

```

```js
const http = require('node:http');

const server = http.createServer((req, res) => {
  // `req` is an http.IncomingMessage, which is a readable stream.
  // `res` is an http.ServerResponse, which is a writable stream.

  let body = '';
  // Get the data as utf8 strings.
  // If an encoding is not set, Buffer objects will be received.
  req.setEncoding('utf8');

  // Readable streams emit 'data' events once a listener is added.
  req.on('data', (chunk) => {
    console.log(chunk);//å¯ä»¥è¼¸å‡ºchunkçœ‹çœ‹
    body += chunk;
  });

  // The 'end' event indicates that the entire body has been received.
  req.on('end', () => {
    console.log(body) //å¯ä»¥è¼¸å‡ºæ•´å€‹bodyçœ‹çœ‹ /
    console.log(typeof body) //å¯ä»¥è¼¸å‡ºæ•´å€‹bodyçœ‹çœ‹  æ˜¯å­—ä¸²
  });
});

server.listen(1337);

```

- data äº‹ä»¶ï¼š
  - æ¯æ”¶åˆ°ä¸€æ®µè³‡æ–™å°±è§¸ç™¼
- chunkï¼š
  - æ˜¯ Buffer
  - ä»£è¡¨ä¸€å°æ®µ request body
- body += chunkï¼š
  - æŠŠè³‡æ–™æ‹¼èµ·ä¾†ï¼ˆæœ€å¾Œæœƒè®Šæˆå®Œæ•´å­—ä¸²ï¼‰

- å°ç…§è¼¸å‡ºï¼šbufferå°±æ˜¯ä¸€å¡Šå¿«çš„chunk
- ![å°åŒ…](/img/api_03.png)

### 3ï¸âƒ£ æ–°å¢ todo POST API
:::tip
- end äº‹ä»¶ï¼š
- è¡¨ç¤º request body å·²å…¨éƒ¨æ¥æ”¶å®Œæˆ

- é€™æ™‚æ‰å¯ä»¥ï¼š
  - JSON.parse(body)
  - å–å‡º POST å‚³ä¾†çš„è³‡æ–™
:::
```js
const http = require("http");
const { v4: uuidv4 } = require('uuid'); //æ–°å¢æ¨¡çµ„
const todos = [ //è³‡æ–™åº«
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦é¢è©¦"
  },
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦åƒæ™šé¤"
  }
];


let body = '';

req.on('data', (chunk) => {
    console.log(chunk);//å¯ä»¥è¼¸å‡ºchunkçœ‹çœ‹
    body += chunk;
  });

const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' 
}

  
  if(req.url == "/todos" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": todos,
    })); 
    res.end(); 
  } else if (req.url == "/todos" && req.method == "POST"){ 
    req.on('end', () => {
      //æˆ‘æ”¶åˆ°çš„æ˜¯å­—ä¸²å°åŒ… æ‰€ä»¥è¦è½‰æˆç‰©ä»¶æ ¼å¼ æ‰èƒ½å–å‡ºkey value
      const title = JSON.parse(body).title;
      const todo = {
        "title": title,
        "id": uuidv4()
      }
      console.log(todo);
      todos.push(todo);
      res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
      res.write(JSON.stringigy({
        "status": "success",
        "data": todos,
      })); 
      res.end();
    });
    
  } else if (req.method == "OPTIONS"){
    res.writeHead(200, headers); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringify({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

### 4ï¸âƒ£ æ–°å¢ POST API ç•°å¸¸è¡Œç‚º try catch

```js
const http = require("http");
const { v4: uuidv4 } = require('uuid'); //æ–°å¢æ¨¡çµ„
const todos = [ //è³‡æ–™åº«
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦é¢è©¦"
  },
  {
    id: uuid4(),
    title: "ä»Šå¤©è¦åƒæ™šé¤"
  }
];


let body = '';

req.on('data', (chunk) => {
    console.log(chunk);//å¯ä»¥è¼¸å‡ºchunkçœ‹çœ‹
    body += chunk;
  });

const requestListener = (req, res) => {

  const headers = {
   'Access-Control-Allow-Headers': 'Content-Type, Authorization, Content-Length, X-Requested-With',
   'Access-Control-Allow-Origin': '*',
   'Access-Control-Allow-Methods': 'PATCH, POST, GET,OPTIONS,DELETE',
    'Content-Type': 'application/json' 
}

  
  if(req.url == "/todos" && req.method == "GET") { //GETè«‹æ±‚
    res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
    res.write(JSON.stringigy({
      "status": "success",
      "data": todos,
    })); 
    res.end(); 
  } else if (req.url == "/todos" && req.method == "POST"){ 
    req.on('end', () => {
      try { //æˆåŠŸå¯«å…¥
            //æˆ‘æ”¶åˆ°çš„æ˜¯å­—ä¸²å°åŒ… æ‰€ä»¥è¦è½‰æˆç‰©ä»¶æ ¼å¼ æ‰èƒ½å–å‡ºkey value
          const title = JSON.parse(body).title;
          if(title !== undefined) {
            //å°±æŠŠè³‡æ–™å¯«å…¥
              const todo = {
                "title": title,
                "id": uuidv4()
              }
              console.log(todo);
              todos.push(todo);
              res.writeHead(200, headers); // æˆåŠŸ å›æ‡‰ header
              res.write(JSON.stringigy({
                "status": "success",
                "data": todos,
              })); 
              res.end();
          } else { //titleä¸å­˜åœ¨ç„¡å€¼çš„è©±
            res.writeHead(400, headers); // å¤±æ•— å›æ‡‰ header
              res.write(JSON.stringigy({
                "status": "false",
                "message": "æ¬„ä½æœªå¡«å¯«æ­£ç¢ºï¼Œç„¡æ­¤todo id",
              })); 
              res.end();
          }

      } catch(error) {
        res.writeHead(400, headers); 
          res.write(JSON.stringigy({
            "status": "false",
            "message": "æ¬„ä½æœªå¡«å¯«æ­£ç¢ºï¼Œç„¡æ­¤todo id",
          })); 
        
        res.end();
      }});
      
    
  } else if (req.method == "OPTIONS"){
    res.writeHead(200, headers); 
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  } else { //ä¸æ˜¯é¦–é  å°±å°å‡º404å›æ‡‰
    res.writeHead(404, headers); // 404 å›æ‡‰ header
    res.write(JSON.stringify({ //æ”¹å¯«JSONå…§å®¹ 404
      "status": "false",
      "message": "ç„¡æ­¤ç¶²ç«™è·¯ç”±",
    })); // å›æ‡‰å…§å®¹
    res.end(); // çµæŸä¸¦é€å‡ºå›æ‡‰
  }
  
};

// å»ºç«‹ server
const server = http.createServer(requestListener);//ä½¿ç”¨è€…é€²å…¥ç¶²å€å°±è§¸ç™¼è«‹æ±‚
server.listen(3005);

```

### 5ï¸âƒ£ é‡æ§‹ POST API ç•°å¸¸è¡Œç‚º

---

